# 거버넌스 및 업그레이드

시그널스 컨트랙트는 UUPS 패턴을 사용하므로 업그레이드 범위가 작지만 영향력이 큽니다. 이 문서는 현재 거버넌스 모델과 새로운 구현을 배포하는 절차를 설명합니다.

## 현재 거버넌스 모델

- **오너**: 단일 계정(EOA 또는 관리 컨트랙트)이 `CLMSRMarketCore`, `CLMSRPosition`, `PointsGranter`를 `Ownable`로 제어합니다. 현재 타임락·멀티시그는 없습니다.
- **권한 범위**: 오너는 구현 업그레이드, 시장 생성/정산, 트레이딩 일시정지, 보조 컨트랙트 관리를 수행할 수 있습니다.
- **로드맵**: 업그레이드와 정산을 다자 검증할 수 있도록 타임락 + 멀티시그 래퍼를 도입할 계획입니다. 그 전까지는 운영 절차에 의존합니다.

## 업그레이드 체크리스트

1. **개발 & 테스트** – 새 구현(`*.sol`)을 작성하고 저장소 레이아웃 호환성을 확인합니다.
2. **배포** – Hardhat Ignition 또는 직접 작성한 배포 스크립트로 구현을 배포하고 주소를 기록합니다.
3. **테스트 실행** – 새로운 바이트코드에 대해 단위/불변성 테스트와 가스 스냅샷을 수행합니다.
4. **업그레이드 브로드캐스트**
   ```bash
   yarn upgrade:citrea:prod
   ```
   디스패처가 `MANIFEST_DEFAULT_DIR`을 설정하고 각 프록시에 `upgradeTo`를 호출합니다.
5. **검증** – `scripts/verify-all.sh`로 새 구현 소스를 익스플로러에 검증합니다.
6. **Manifest 업데이트** – `deployments/environments/*.json`에 버전·타임스탬프·주소를 추가합니다.
7. **공지** – 변경된 동작을 요약한 변경 이력을 게시합니다.

## 롤백 절차

- 업그레이드를 되돌려야 할 경우 이전 구현을 다시 배포하고 `upgradeTo`로 옛 주소를 지정합니다.
- 상태는 유지되므로 기존 코드가 동일한 저장소 레이아웃을 사용하는지 반드시 확인하세요.

## 설정 변경

OutcomeSpec이나 `α`와 같은 파라미터 변경은 새 시장을 만들 때 적용됩니다. 진행 중인 시장을 수정해야 한다면 `updateMarketTiming`으로 시간 파라미터만 조정하세요. 수수료나 다른 가격 소스 도입처럼 구조적 변화는 새 구현을 작성하고 위 업그레이드 절차를 따라야 합니다.

## 투명성 확보

- 릴리스 노트는 [`website/docs/changelog`](/docs/changelog/index.md)에 정리되어 있습니다.
- 배포 manifest는 버전 관리되고 PR로 검토됩니다.
- 향후 거버넌스 레이어(타임락/멀티시그 등)가 도입되면 본 절차와 함께 운영 가이드를 공개해 통합자가 대비할 수 있도록 할 예정입니다.
